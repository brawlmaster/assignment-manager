<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="theme-color" content="#0b0f1a">
    <meta name="description" content="Offline PWA To‑Do with reminders and progress tracking">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="icon" href="/icons/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icons/icon.svg">
    <link rel="stylesheet" href="/styles.css">
    <title>Tasks (Offline PWA)</title>
</head>
<body>
    <header class="app-header">
        <h1 class="app-title">Tasks</h1>
        <div class="header-actions">
            <button id="enableNotificationsBtn" class="btn btn-secondary" hidden>Enable notifications</button>
            <button id="deleteModeBtn" class="btn btn-danger" title="Select tasks to remove">Manage</button>
        </div>
    </header>

    <main class="container">
        <section class="stats">
            <div class="progress">
                <div id="progressBar" class="progress-bar"></div>
            </div>
            <div class="progress-text">
                <span id="progressText">0 of 0 done</span>
                <span id="dueSoonText" class="due-soon">0 due soon</span>
            </div>
        </section>

        <section id="listSection" class="list-section">
            <ul id="taskList" class="task-list" aria-live="polite"></ul>
            <div class="list-actions">
                <button id="addTaskBtn" class="btn btn-primary">Add new task</button>
            </div>
        </section>
    </main>

    <div id="bulkDeleteBar" class="bulk-delete" hidden>
        <span>Select tasks to remove</span>
        <div class="spacer"></div>
        <button id="confirmDeleteBtn" class="btn btn-danger">Delete selected</button>
        <button id="cancelDeleteBtn" class="btn btn-secondary">Cancel</button>
    </div>

    <dialog id="taskDialog" class="task-dialog">
        <form id="taskForm" method="dialog">
            <h2 id="dialogTitle">Add task</h2>
            <input type="hidden" id="taskId">
            <label class="field">
                <span>Title</span>
                <input id="taskTitle" type="text" required maxlength="200" placeholder="What do you need to do?">
            </label>
            <label class="field">
                <span>Details</span>
                <textarea id="taskDetails" rows="3" placeholder="Optional notes"></textarea>
            </label>
            <div class="field-grid">
                <label class="field">
                    <span>Due date & time</span>
                    <input id="taskDue" type="datetime-local" required>
                </label>
                <label class="field">
                    <span>Importance (1–10)</span>
                    <input id="taskImportance" type="range" min="1" max="10" value="5">
                </label>
            </div>
            <label class="field">
                <span>Tags</span>
                <input id="taskTags" type="text" placeholder="Comma‑separated (optional)">
            </label>

            <div class="dialog-actions">
                <button type="submit" class="btn btn-primary">Save</button>
                <button type="button" id="cancelDialogBtn" class="btn btn-secondary">Cancel</button>
            </div>
        </form>
    </dialog>

    <template id="taskItemTemplate">
        <li class="task-item">
            <label class="select-box" hidden>
                <input type="checkbox" class="select-checkbox">
            </label>
            <label class="checkbox">
                <input type="checkbox" class="complete-checkbox">
                <span class="checkmark" aria-hidden="true"></span>
            </label>
            <div class="task-content">
                <div class="title-row">
                    <span class="title"></span>
                    <span class="badge importance"></span>
                    <span class="badge due-soon-badge" hidden>Due soon</span>
                </div>
                <div class="meta">
                    <span class="due"></span>
                    <span class="tags"></span>
                </div>
                <div class="details"></div>
            </div>
            <button class="btn btn-ghost edit-btn" title="Edit">✎</button>
        </li>
    </template>

    <script src="/scripts/app.js" type="module"></script>
</body>
</html>

